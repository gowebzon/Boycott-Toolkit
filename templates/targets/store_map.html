{% extends "base.html" %}
{%block css%}
 <link rel="stylesheet" href="{{MEDIA_URL}}styles/target.css" type="text/css"/>
{%endblock%}
{% block title %}Stores{% endblock %}

{%block content%}

{% include "geography/map_snippet.html" %}

<script type="text/javascript">
$ = jQuery.noConflict();

$(document).ready(function() {
  var storeStyles = new OpenLayers.StyleMap(
    {pointRadius: 10,
    fillOpacity:1,
    externalGraphic:"/media/openlayers/img/marker-red.png",
    strokeColor:'#FF0000'});
    
    stores = new OpenLayers.Layer.Vector("Stores", {
                         strategies: [new OpenLayers.Strategy.Fixed()],
                         protocol: new OpenLayers.Protocol.HTTP({
                                   url: "/target/store/all.json",
                                   format: new OpenLayers.Format.GeoJSON()}),
                                   styleMap:storeStyles,
                                   visibility:true});
    map.addLayer(stores);
});
</script>
<br>
<ul style="font-size:12px; float:left;">
 <b>Stores:</b>
{% for store in stores %}
<li>{{store.name}}, {{store.address}}
  <ul>
    {% for product in store.products.all %}
    <li><a href="{{product.get_absolute_url}}">{{product.name}}</a>
    {%endfor%}
    </ul>
{%endfor%}
</ul>
{%endblock%}